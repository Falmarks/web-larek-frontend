# Проектная работа "Веб-ларек"

## Технический стек

- HTML
- SCSS
- TypeScript
- Webpack

## Структура проекта
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

## Важные файлы
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды:



npm install
npm run start


или


yarn
yarn start

## Сборка


npm run build


или


yarn build

## Данные и типы данных, используемые в приложении

### Основные интерфейсы

#### Карточка товара

```typescript
export interface ICard {
  _id: string;
  title: string;
  category: string;
  description: string;
  price: number | null;
  image: string;
}
```

#### Данные клиента

```typescript
export interface IClient {
  payment: 'cash' | 'card';
  address: string;
  email: string;
  phone: string;
}
```

#### Модель данных массива карточек

```typescript
export interface ICardsData {
  cards: ICard[];
  preview: string | null;
}
```

#### Основные данные пользователя, которые можно редактировать при оформлении заказа

```typescript
export type TClientModalPaymentAddress = Pick<IClient, 'payment' | 'address'>;
export type TClientModalNumberMail = Pick<IClient, 'email' | 'phone'>;
```

#### Данные карточек в корзине

```typescript
export type CardInfoInBasket = Pick<ICard, 'title'| 'price'>
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:

- **Слой представления** - отвечает за отображение данных на странице
- **Слой данных** - отвечает за хранение и изменение данных
- **Презентер** - отвечает за связь представления и данных

## Базовый код

### Класс Api

Содержит в себе базовую логику отправки запросов.\ В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.

## Импорты

```typescript
import { ApiPostMethods, IApi } from '../../types';
```

## Типы

### ApiListResponse<Type>

```typescript
{
    total: number;    // Общее количество элементов
    items: Type[];    // Массив элементов указанного типа
}
```

## Конструктор

### `constructor(baseUrl: string, options: RequestInit = {})`

Создает экземпляр API клиента.

**Параметры:**
- `baseUrl` - Базовый URL для всех запросов
- `options` - Опциональные настройки запроса по умолчанию

## Свойства

### `readonly baseUrl: string`
Базовый URL, переданный в конструктор.

### `protected options: RequestInit`
Защищенные настройки запроса, включая заголовки по умолчанию.

## Методы

### `get<T>(uri: string): Promise<T>`

Выполняет GET-запрос к указанному endpoint.

**Параметры:**
- `uri` - URI endpoint (добавляется к baseUrl)
- Возвращает промис с данными ожидаемого типа

### `post<T>(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<T>`

Выполняет POST-запрос (или другие методы) с передачей данных.

**Параметры:**
- `uri` - URI endpoint
- `data` - Данные для отправки (будут преобразованы в JSON)
- `method` - HTTP метод (по умолчанию: 'POST')
- Возвращает промис с ответом ожидаемого типа

## Защищенные методы

### `protected handleResponse<T>(response: Response): Promise<T>`

Обрабатывает ответ от сервера. Если ответ успешный (status 200-299), преобразует JSON в объект. В случае ошибки пытается извлечь сообщение об ошибке из ответа.

**Параметры:**
- `response` - Объект ответа Fetch API
- Возвращает разобранный JSON или rejected промис с ошибкой
### Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события.

- Используется в презентере для обработки событий
- **Основные методы**:
    - `on` - подписка на событие
    - `emit` - инициализация события
    - `trigger` - возвращает функцию для инициализации события

## Слой данных

### Класс CardsData

Менеджер для работы с данными карточек. Обеспечивает хранение, получение и управление коллекцией карточек.

#### Импорты

```typescript
import { ICardData } from '../../types';
import { IEvents } from '../base/events';
```

#### Конструктор

###### `constructor(events: IEvents)`

Создает экземпляр менеджера карточек.

**Параметры:**
- `events` - Объект для работы с событиями

#### Свойства

##### `protected _cards: ICardData[]`
Защищенный массив для хранения карточек.

##### `protected events: IEvents`
Защищенный объект для управления событиями.

#### Методы

##### `getCard(cardId: string): ICardData | undefined`

Находит карточку по идентификатору.

**Параметры:**
- `cardId` - Идентификатор карточки для поиска
- Возвращает найденную карточку или undefined

##### `setCards(cards: ICardData[]): void`

Устанавливает новую коллекцию карточек и инициирует событие об изменении.

**Параметры:**
- `cards` - Массив карточек для установки

##### `getCards(): ICardData[]`

Возвращает текущую коллекцию карточек.

**Возвращает:**
- Массив всех карточек

### Класс BasketData

Отвечает за хранение и логику работы с данными корзины.

- Конструктор принимает инстанс брокера событий
- **Поля**:
    - `_basket: ICardBasket` - массив товаров в корзине
    - `events: IEvents` - брокер событий
- **Методы**:
    - `addCard(card: ICardBasket)` - добавление товара
    - `deleteCard(id: string)` - удаление товара
    - `getTotalBasketPrice(): number` - расчет общей суммы
    - `cardInBasket(id: string): boolean` - проверка наличия товара

### Класс ClientData

Отвечает за хранение и логику работы с данными клиента.

- Конструктор принимает инстанс брокера событий
- **Поля**:
    - `payment: string`
    - `address: string`
    - `email: string`
    - `phone: string`
- **Методы**:
    - `setClientPayment(value: {payment: string})`
    - `setClientAddress(value: {address: string})`
    - `setClientEmail(value: {email: string})`
    - `setClientPhone(value: {phone: string})`
    - `validatePayment()`
    - `validateContacts()`

## Классы представления

### Базовый Класс Component

Дженерик-класс и родитель всех компонентов слоя представления.

- В конструктор принимает DOM-элемент контейнера
- Содержит метод `render` для отображения данных в компоненте

## Документация класса Modal

### Общее описание

Класс Modal представляет собой компонент модального окна, наследующий функционал от базового класса Component. Компонент отвечает за отображение модального окна с возможностью открытия, закрытия и управления содержимым.

### Импорты и зависимости

- `Component` - базовый класс компонента (`…/base/Component`)
- `ensureElement` - утилита для поиска элементов (`…/…/utils/utils`)
- `IEvents` - интерфейс событий (`…/base/events`)
- `IModal` - тип данных модального окна (`…/…/types`)

### Структура класса

#### Свойства

- `_closeButton: HTMLButtonElement` - кнопка закрытия модального окна
- `_content: HTMLElement` - контейнер содержимого модального окна
- `events: IEvents` - объект для работы с событиями

#### Конструктор

`constructor(container: HTMLElement, protected events: IEvents)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями

#### Методы и функциональность

**Сеттер content**
- `set content(value: HTMLElement)` - Устанавливает содержимое модального окна.

**Метод open**
- Добавляет класс `modal_active` к контейнеру
- Отправляет событие `modal:open`
- Подписывается на событие `Esc`

**Метод close**
- Удаляет класс `modal_active`
- Очищает содержимое
- Отправляет событие `modal:close`
- Отписывается от события `Esc`

**Метод handleEscUp**
- Обработчик нажатия клавиши `Esc` для закрытия модального окна.

**Метод render**
- `render(data: IModal): HTMLElement` - Вызывает родительский метод рендеринга, открывает модальное окно, возвращает контейнер компонента.

## Basket

### Общее описание

Класс представляет компонент корзины покупок.

### Импорты

- `IEvents` - интерфейс событий
- `IBasket`, `ICardBasket` - типы данных
- `Component` - базовый класс
- `ensureElement` - утилита для поиска элементов

### Свойства

- `events: IEvents` - объект для взаимодействия с событиями
- `basketList: HTMLElement` - контейнер списка товаров
- `totalPrice: HTMLSpanElement` - элемент общей стоимости
- `orderButton: HTMLButtonElement` - кнопка оформления заказа
- `container: HTMLElement` - родительский контейнер

### Конструктор

`constructor(container: HTMLElement, events: IEvents)`

### Сеттеры

- `set list` - обновляет содержимое корзины
- `set total` - устанавливает общую стоимость
- `set valid` - управляет доступностью кнопки оформления

## Документация класса Card

### Общее описание

Класс Card представляет собой базовый компонент карточки, наследующий функционал от класса Component. Компонент отвечает за отображение и управление основными элементами карточки: заголовком и ценой.

### Импорты и зависимости

- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `Component` - базовый класс компонента (из `…/base/Component`)
- `IEvents` - интерфейс событий (из `…/base/events`)

### Структура класса

#### Свойства

- `cardTitle: HTMLElement` - элемент заголовка карточки
- `cardPrice: HTMLSpanElement` - элемент отображения цены
- `events: IEvents` - объект для работы с событиями
- `id: string` - идентификатор карточки
- `container: HTMLElement (protected)` - родительский контейнер компонента

#### Конструктор

`constructor(protected container: HTMLElement)`

**Параметры**:
- `container` - родительский HTML-элемент

#### Методы и сеттеры

**Сеттер title**
- `set title(value: string)` - Устанавливает текст заголовка карточки.

**Сеттер price**
- `set price(value: number | null)` - Устанавливает значение цены карточки.

**Сеттер _id**
- `set _id(value: string)` - Устанавливает идентификатор карточки.

## CardBasket

### Общее описание

Класс CardBasket представляет компонент корзины, наследующий функционал от базового класса Card.

### Импорты

- `Card` - базовый класс для карточек
- `IEvents` - интерфейс для работы с событиями
- `ICardBasket` - тип данных для карточки корзины
- `ensureElement` - утилита для поиска элементов в DOM

### Структура класса

**Наследуемый класс**: `Card<ICardBasket>`

#### Свойства класса

- `events: IEvents` - объект для работы с событиями
- `cardIndex: HTMLSpanElement` - элемент отображения индекса карточки
- `deleteButton: HTMLButtonElement` - кнопка удаления карточки
- `container: HTMLElement` - родительский контейнер компонента

#### Конструктор

`constructor(protected container: HTMLElement, events: IEvents)`

#### Методы

- `set index(value: number)` - сеттер для установки индекса карточки

#### События

- При клике на кнопку удаления: `this.events.emit('card:delete', this)`

## Документация класса CardCatalog

### Общее описание

Класс CardCatalog представляет каталог карточек, наследуемый от базового класса Card.

### Импорты

- `Card` - базовый класс для работы с карточками
- `IEvents` - интерфейс событий
- `ensureElement` - утилита для проверки и создания элементов
- `ICardCatalog` - тип данных для карточки каталога
- `CDN_URL` - константа URL для CDN

### Свойства класса

- `cardClass: Record<string, string>` - объект классов карточек
- `cardCategory: HTMLSpanElement` - элемент категории карточки
- `cardImage: HTMLImageElement` - элемент изображения карточки
- `events: IEvents` - объект событий
- `container: HTMLElement` - контейнер карточки

### Конструктор

`constructor(container: HTMLElement, events: IEvents, category: Record<string, string>)`

### Методы и сеттеры

- Обработчик клика - отправляет событие `'card:open'` с ID карточки
- `set price(price: number)` - устанавливает цену карточки
- `set category(value: string)` - устанавливает категорию карточки
- `set image(value: string)` - устанавливает изображение карточки

## Документация класса CardCatalog

### Общее описание

Класс CardCatalog представляет собой компонент каталога карточек, наследующий функционал от класса Card. Компонент отвечает за отображение и управление карточками каталога с возможностью установки цены, категории и изображения.

### Импорты и зависимости

- `Card` - базовый класс карточки (из `./Card`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `ICardCatalog` - тип данных карточки (из `…/…/types`)
- `CDN_URL` - константа URL для CDN (из `…/…/utils/constants`)

### Структура класса

#### Свойства

- `cardClass: Record<string, string>` - объект классов карточек
- `cardCategory: HTMLSpanElement` - элемент категории карточки
- `cardImage: HTMLImageElement` - элемент изображения карточки
- `events: IEvents` - объект для работы с событиями
- `container: HTMLElement (protected)` - родительский контейнер компонента

#### Конструктор

`constructor(protected container: HTMLElement, events: IEvents, category: Record<string, string>)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями
- `category` - объект категорий карточек

#### Методы и сеттеры

**Сеттер price**
- `set price(price: number)` - Устанавливает цену карточки:
    - Если значение существует - отображает число
    - Если значение `null` - отображает “Бесценно”

**Сеттер category**
- `set category(value: string)` - Устанавливает категорию карточки:
    - Применяет соответствующий CSS-класс
    - Устанавливает текст категории

**Сеттер image**
- `set image(value: string)` - Устанавливает изображение карточки:
    - Формирует полный URL с учетом CDN
    - Изменяет расширение на `.png`

## Документация класса CardPreview

### Общее описание

Класс CardPreview представляет собой компонент превью карточки товара, наследующий функционал от класса Card. Компонент отвечает за отображение карточки с возможностью добавления/удаления из корзины.

### Импорты и зависимости

- `Card` - базовый класс карточки (из `./Card`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `ICardData` - тип данных карточки (из `…/…/types`)
- `CDN_URL` - константа URL для CDN (из `…/…/utils/constants`)

### Структура класса

#### Свойства

- `cardClass: Record<string, string>` - объект классов карточек
- `cardCategory: HTMLSpanElement` - элемент категории карточки
- `cardImage: HTMLImageElement` - элемент изображения карточки
- `cardDescription: HTMLElement` - элемент описания
- `putButton: HTMLButtonElement` - кнопка добавления в корзину
- `isInCart: boolean` - состояние наличия в корзине
- `events: IEvents` - объект для работы с событиями
- `cardPrice: HTMLElement` - элемент отображения цены
- `container: HTMLElement (protected)` - родительский контейнер компонента

#### Конструктор

`constructor(protected container: HTMLElement, events: IEvents, category: Record<string, string>)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями
- `category` - объект категорий карточек

#### Методы и функциональность

**Сеттеры**
- `price(price: number)` - установка цены с управлением состоянием кнопки
- `category(value: string)` - установка категории с CSS-классами
- `image(value: string)` - установка изображения с обработкой URL
- `description(value: string)` - установка описания

**Методы управления состоянием**
- `setState(isInCart: boolean)` - установка состояния корзины
- `updateButtonText()` - обновление текста кнопки

**Обработка событий**
- Обработка клика по кнопке добавления в корзину
- Отправка события `‘card:put’` с информацией о действии
- Управление текстом кнопки в зависимости от состояния корзины
- Управление активностью кнопки в зависимости от цены

## Документация класса Form

### Общее описание

Класс Form представляет собой базовый компонент формы, наследующий функционал от класса Component. Компонент обеспечивает базовую функциональность для работы с формами, включая валидацию и управление состоянием.

### Импорты и зависимости

- `Component` - базовый класс компонента (из `…/base/Component`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)

### Структура класса

#### Свойства

- `form: HTMLFormElement` - корневой элемент формы
- `errorsElement: HTMLElement` - элемент для отображения ошибок
- `submitButton: HTMLButtonElement` - кнопка отправки формы
- `events: IEvents` - объект для работы с событиями
- `container: HTMLFormElement` - родительский контейнер компонента

#### Конструктор

`constructor(container: HTMLFormElement, events: IEvents)`

**Параметры**:
- `container` - HTML-элемент формы
- `events` - объект для работы с событиями

#### Методы и функциональность

**Сеттеры**
- `errors(value: string)` - установка текста ошибок
- `valid(value: boolean)` - управление доступностью кнопки отправки

**Основные методы**
- `clear()` - очистка формы:
    - Сброс значений полей
    - Очистка сообщений об ошибках

## Документация класса Gallery

### Общее описание

Класс Gallery представляет собой компонент галереи изображений, наследующий функционал от класса Component. Компонент отвечает за отображение и обновление элементов галереи.

### Импорты и зависимости

- `IEvents` - интерфейс событий (из `…/base/events`)
- `Component` - базовый класс компонента (из `…/base/Component`)

### Интерфейс данных

```typescript
interface IGallery {
  galleryLoad: HTMLElement[]
}
```

### Структура класса

#### Свойства

- `events: IEvents` - объект для работы с событиями
- `container: HTMLElement` - родительский контейнер компонента

#### Конструктор

`constructor(container: HTMLElement, protected events: IEvents)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями

#### Методы и функциональность

**Сеттер galleryLoad**
- `set galleryLoad(value: HTMLElement[])` - Функционал:
    - Заменяет все дочерние элементы контейнера на переданный массив элементов
    - Позволяет динамически обновлять содержимое галереи

## Документация класса Header

### Общее описание

Класс Header представляет собой компонент заголовка приложения, наследующий функционал от класса Component. Компонент отвечает за отображение и управление элементыми заголовка, включая счетчик товаров в корзине и кнопку открытия корзины.

### Импорты и зависимости

- `IHeader` - тип данных заголовка (из `…/…/types`)
- `Component` - базовый класс компонента (из `…/base/Component`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)

### Структура класса

#### Свойства

- `events: IEvents` - объект для работы с событиями
- `cardsCounter: HTMLElement` - элемент счетчика товаров в корзине
- `basketButton: HTMLButtonElement` - кнопка открытия корзины
- `container: HTMLElement (protected)` - родительский контейнер компонента

#### Конструктор

`constructor(protected container: HTMLElement, events: IEvents)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями

#### Методы и функциональность

**Сеттер count**
- `set count(value: number)` - Устанавливает значение счетчика товаров в корзине.

**Обработка событий**
- Обработка клика по кнопке корзины:
    - Отправка события `‘basket:open’`
    - Логирование открытия корзины

## Документация класса OrderContactsForm

### Общее описание

Класс OrderContactsForm представляет собой компонент формы заказа контактов, наследующий функционал от класса Form. Компонент отвечает за сбор и валидацию контактной информации клиента (email и телефон).

### Импорты и зависимости

- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `TOrderNumberMail` - тип данных формы (из `…/…/types`)
- `Form` - базовый класс формы (из `./Form`)

### Структура класса

#### Свойства

- `emailInput: HTMLInputElement` - поле ввода email
- `phoneInput: HTMLInputElement` - поле ввода телефона
- `events: IEvents` - объект для работы с событиями
- `form: HTMLFormElement` - корневой элемент формы
- `errorsElement: HTMLElement` - элемент для отображения ошибок
- `submitButton: HTMLButtonElement` - кнопка отправки формы

#### Конструктор

`constructor(container: HTMLFormElement, events: IEvents)`

**Параметры**:
- `container` - HTML-элемент формы
- `events` - объект для работы с событиями

#### Методы и функциональность

**Обработка событий ввода**

- `emailInput`:
    - Отслеживание изменений через событие `input`
    - Отправка события `‘orderContactsForm:changedEmailInput’`
- `phoneInput`:
    - Отслеживание изменений через событие `input`
    - Отправка события `‘orderContactsForm:changedPhoneInput’`

**Обработка отправки формы**
- Предотвращение стандартного поведения (`preventDefault`)
- Очистка формы
- Отправка события `‘orderContactsForm:submit’`

## Документация класса OrderPaymentForm

### Общее описание

Класс OrderPaymentForm представляет собой компонент формы оплаты заказа, наследующий функционал от класса Form. Компонент отвечает за выбор способа оплаты и ввод адреса доставки.

### Импорты и зависимости

- `TOrderPaymentAddress` - тип данных формы (из `…/…/types`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `Form` - базовый класс формы (из `./Form`)

### Структура класса

#### Свойства

- `cashButton: HTMLButtonElement` - кнопка выбора оплаты наличными
- `onlineButton: HTMLButtonElement` - кнопка выбора оплаты картой
- `addressInput: HTMLInputElement` - поле ввода адреса
- `events: IEvents` - объект для работы с событиями
- `form: HTMLFormElement` - корневой элемент формы
- `errorsElement: HTMLElement` - элемент для отображения ошибок
- `submitButton: HTMLButtonElement` - кнопка отправки формы

#### Конструктор

`constructor(container: HTMLFormElement, events: IEvents)`

**Параметры**:
- `container` - HTML-элемент формы
- `events` - объект для работы с событиями

#### Методы и функциональность

**Обработка событий выбора способа оплаты**

- `cashButton`:
    - Отправка события `‘orderPaymentForm:changedButton’` с параметром `payment:‘cash’`
- `onlineButton`:
    - Отправка события `‘orderPaymentForm:changedButton’` с параметром `payment:‘card’`

**Обработка ввода адреса**

- `addressInput`:
    - Отслеживание изменений через событие `input`
    - Отправка события `‘orderPaymentForm:changedInput’` с текущим значением адреса

**Обработка отправки формы**
- Предотвращение стандартного поведения (`preventDefault`)
- Очистка формы
- Отправка события `‘orderPaymentForm:submit’`

**Сеттер paymentMethod**
- `set paymentMethod(value: string)` - Управление визуальным состоянием кнопок:
    - При выборе `‘card’`:
        - Добавление класса `‘button_alt-active’` к `onlineButton`
        - Удаление класса `‘button_alt-active’` от `cashButton`
    - При выборе другого значения:
        - Добавление класса `‘button_alt-active’` к `cashButton`
        - Удаление класса `‘button_alt-active’` от `onlineButton`

## Документация класса Page

### Общее описание

Класс Page представляет собой базовый компонент страницы, наследующий функционал от класса Component. Компонент отвечает за управление состоянием блокировки страницы.

### Импорты и зависимости

- `Component` - базовый класс компонента (из `…/base/Component`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)

### Интерфейс данных

```typescript
interface IPage {
  locked: boolean;
}
```

### Структура класса

#### Свойства

- `_wrapper: HTMLElement` - обертка содержимого страницы
- `events: IEvents` - объект для работы с событиями
- `container: HTMLElement` - родительский контейнер компонента

#### Конструктор

`constructor(container: HTMLElement, protected events: IEvents)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями

#### Методы и функциональность

**Сеттер locked**
- `set locked(value: boolean)` - Управление состоянием блокировки:
    - При `true`:
        - Добавление класса `‘page__wrapper_locked’` к обертке
    - При `false`:
        - Удаление класса `‘page__wrapper_locked’` от обертки

## Документация класса Success

### Общее описание

Класс Success представляет собой компонент успешного завершения заказа, наследующий функционал от класса Component. Компонент отображает информацию об успешной операции и общую стоимость.

### Импорты и зависимости

- `Component` - базовый класс компонента (из `…/base/Component`)
- `IEvents` - интерфейс событий (из `…/base/events`)
- `ensureElement` - утилита для поиска элементов (из `…/…/utils/utils`)
- `ISuccess` - тип данных успеха (из `…/…/types`)

### Структура класса

#### Свойства

- `successButton: HTMLButtonElement` - кнопка закрытия окна успеха
- `totalPrice: HTMLElement` - элемент отображения общей стоимости
- `events: IEvents` - объект для работы с событиями
- `container: HTMLElement` - родительский контейнер компонента

#### Конструктор

`constructor(container: HTMLElement, events: IEvents)`

**Параметры**:
- `container` - родительский HTML-элемент
- `events` - объект для работы с событиями

#### Методы и функциональность

**Обработка событий**

- `successButton`:
    - При клике отправляет событие `‘success’`

**Сеттер total**
- `set total(value: number)` - Устанавливает и отображает общую стоимость:
    - Форматирует текст как “Списано X синапсов”
    - Выводит значение в консоль перед установкой

## Слой коммуникации

### Класс AppApi

- Принимает в конструктор экземпляр класса `Api`
- Предоставляет методы для взаимодействия с бэкендом

## Взаимодействие компонентов

Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.
Код взаимодействия находится в файле `index.ts` (презентер)

Данный презентер управляет интернет-магазином с корзиной товаров. Вот все события, которые он обрабатывает:

### События загрузки данных
- **Загрузка карточек товаров**: При инициализации загружает данные карточек через API
- `cards:changed` - обновление отображения галереи товаров при изменении данных

### События работы с карточками товаров
- `card:open` - открытие модального окна с детальной информацией о товаре
- `card:put` - добавление/удаление товара в корзину (переключение состояния)
- `card:delete` - удаление конкретного товара из корзины

### События работы с корзиной
- `basketCards:changed` - обновление отображения корзины при изменении её содержимого
- `basket:open` - открытие модального окна корзины

### События оформления заказа
- `orderPaymentForm:open` - открытие формы оплаты заказа
- `orderPaymentForm:changedButton` - изменение способа оплаты
- `orderPaymentForm:changedInput` - изменение адреса доставки
- `orderPaymentForm:submit` - отправка формы оплаты и переход к форме контактов

### События формы контактов
- `orderContactsForm:changedEmailInput` - изменение email
- `orderContactsForm:changedPhoneInput` - изменение телефона
- `orderContactsForm:submit` - отправка данных заказа на сервер

### События валидации
- `clientData:changed` - проверка валидности данных клиента

### События модальных окон
- `modal:open` - блокировка страницы при открытии модального окна
- `modal:close` - разблокировка страницы при закрытии модального окна

### Событие успешного заказа
- `success` - обработка успешного оформления заказа (очистка корзины, закрытие модального окна)

Презентер реализует полный цикл работы приложения: от загрузки товаров через выбор товаров, работу с корзиной до оформления заказа и обработки успешного завершения покупки.